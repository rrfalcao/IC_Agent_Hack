{"version":3,"sources":["../src/types/network.ts","../src/types/payment.ts","../src/types/schemas.ts","../src/types/responses.ts","../src/client/facilitator.ts","../src/utils/nonce.ts","../src/utils/validation.ts","../src/utils/errors.ts","../src/client/prepareWitness.ts","../src/client/signWitness.ts","../src/client/prepareAuthorization.ts","../src/client/signAuthorization.ts","../src/utils/encoding.ts","../src/client/createPaymentHeader.ts","../src/client/selectPaymentDetails.ts","../src/client/resourceServer.ts","../src/contracts/abi.ts","../src/facilitator/verification.ts","../src/facilitator/settlement.ts","../src/index.ts"],"names":[],"mappings":"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","file":"index.mjs","sourcesContent":["/**\n * Supported EVM networks for q402 protocol\n */\nexport const SupportedNetworks = {\n  BSC_MAINNET: \"bsc-mainnet\",\n  BSC_TESTNET: \"bsc-testnet\",\n} as const;\n\nexport type SupportedNetwork = (typeof SupportedNetworks)[keyof typeof SupportedNetworks];\n\n/**\n * Network configuration for different chains\n */\nexport interface NetworkConfig {\n  chainId: number;\n  name: string;\n  rpcUrl: string;\n  explorer: string;\n}\n\n/**\n * Network configurations\n */\nexport const NetworkConfigs: Record<SupportedNetwork, NetworkConfig> = {\n  [SupportedNetworks.BSC_MAINNET]: {\n    chainId: 56,\n    name: \"BNB Smart Chain Mainnet\",\n    rpcUrl: \"https://bsc-dataseed1.binance.org\",\n    explorer: \"https://bscscan.com\",\n  },\n  [SupportedNetworks.BSC_TESTNET]: {\n    chainId: 97,\n    name: \"BNB Smart Chain Testnet\",\n    rpcUrl: \"https://data-seed-prebsc-1-s1.binance.org:8545\",\n    explorer: \"https://testnet.bscscan.com\",\n  },\n};\n\n","import type { Address, Hex } from \"viem\";\nimport type { AuthorizationTuple } from \"./eip7702\";\nimport type { WitnessTypedData, BatchWitnessTypedData, PaymentItem } from \"./eip712\";\nimport type { SupportedNetwork } from \"./network\";\n\n// Re-export PaymentItem for external use\nexport type { PaymentItem } from \"./eip712\";\n\n/**\n * Payment scheme identifier\n */\nexport const PaymentScheme = {\n  EIP7702_DELEGATED: \"evm/eip7702-delegated-payment\",\n  EIP7702_DELEGATED_BATCH: \"evm/eip7702-delegated-batch\",\n} as const;\n\nexport type PaymentSchemeType = (typeof PaymentScheme)[keyof typeof PaymentScheme];\n\n/**\n * Payment details returned by resource server in 402 response\n */\nexport interface PaymentDetails {\n  /**\n   * Payment scheme identifier\n   */\n  scheme: PaymentSchemeType;\n\n  /**\n   * Network identifier\n   */\n  networkId: SupportedNetwork;\n\n  /**\n   * Token contract address\n   */\n  token: Address;\n\n  /**\n   * Payment amount in atomic units\n   */\n  amount: string;\n\n  /**\n   * Recipient address (resource server settlement wallet)\n   */\n  to: Address;\n\n  /**\n   * Implementation contract address (whitelisted delegation target)\n   */\n  implementationContract: Address;\n\n  /**\n   * EIP-712 witness typed data\n   */\n  witness: WitnessTypedData | BatchWitnessTypedData;\n\n  /**\n   * Authorization tuple template (without signature)\n   */\n  authorization: {\n    chainId: number;\n    address: Address;\n    nonce: number;\n  };\n}\n\n/**\n * Batch payment details\n */\nexport interface BatchPaymentDetails extends Omit<PaymentDetails, \"token\" | \"amount\" | \"witness\"> {\n  scheme: typeof PaymentScheme.EIP7702_DELEGATED_BATCH;\n  items: PaymentItem[];\n  witness: BatchWitnessTypedData;\n}\n\n/**\n * Signed payment payload for X-PAYMENT header\n */\nexport interface SignedPaymentPayload {\n  /**\n   * Witness signature (EIP-712)\n   */\n  witnessSignature: Hex;\n\n  /**\n   * Signed authorization tuple (EIP-7702)\n   */\n  authorization: AuthorizationTuple;\n\n  /**\n   * Payment details\n   */\n  paymentDetails: PaymentDetails | BatchPaymentDetails;\n}\n\n/**\n * 402 Payment Required response\n */\nexport interface PaymentRequiredResponse {\n  /**\n   * Protocol version\n   */\n  x402Version: number;\n\n  /**\n   * Accepted payment methods\n   */\n  accepts: PaymentDetails[];\n\n  /**\n   * Optional error message\n   */\n  error?: string;\n}\n\n/**\n * Payment execution response\n */\nexport interface PaymentExecutionResponse {\n  /**\n   * Transaction hash\n   */\n  txHash: Hex;\n\n  /**\n   * Block number\n   */\n  blockNumber?: bigint;\n\n  /**\n   * Transaction status\n   */\n  status: \"pending\" | \"confirmed\" | \"failed\";\n\n  /**\n   * Transfer events or receipts\n   */\n  transfers?: Array<{\n    token: Address;\n    from: Address;\n    to: Address;\n    amount: bigint;\n  }>;\n\n  /**\n   * Error message if failed\n   */\n  error?: string;\n}\n\n","import { z } from \"zod\";\nimport { SupportedNetworks, type SupportedNetwork } from \"./network\";\nimport { PaymentScheme } from \"./payment\";\n\n/**\n * Address validation schema (Ethereum address)\n */\nexport const AddressSchema = z.string().regex(/^0x[0-9a-fA-F]{40}$/);\n\n/**\n * Hex string validation schema\n */\nexport const HexSchema = z.string().regex(/^0x[0-9a-fA-F]+$/);\n\n/**\n * BigInt string schema\n */\nexport const BigIntStringSchema = z.string().regex(/^\\d+$/);\n\n/**\n * Network schema\n */\nexport const NetworkSchema = z.enum([\n  SupportedNetworks.BSC_MAINNET,\n  SupportedNetworks.BSC_TESTNET,\n] as [SupportedNetwork, ...SupportedNetwork[]]);\n\n/**\n * Payment scheme schema\n */\nexport const PaymentSchemeSchema = z.enum([\n  PaymentScheme.EIP7702_DELEGATED,\n  PaymentScheme.EIP7702_DELEGATED_BATCH,\n]);\n\n/**\n * EIP-712 domain schema\n */\nexport const Eip712DomainSchema = z.object({\n  name: z.string(),\n  version: z.string().optional(),\n  chainId: z.number(),\n  verifyingContract: AddressSchema,\n});\n\n/**\n * Witness message schema\n */\nexport const WitnessMessageSchema = z.object({\n  owner: AddressSchema,\n  token: AddressSchema,\n  amount: BigIntStringSchema,\n  to: AddressSchema,\n  deadline: BigIntStringSchema,\n  paymentId: HexSchema,\n  nonce: BigIntStringSchema,\n});\n\n/**\n * Payment item schema\n */\nexport const PaymentItemSchema = z.object({\n  token: AddressSchema,\n  amount: BigIntStringSchema,\n  to: AddressSchema,\n});\n\n/**\n * Batch witness message schema\n */\nexport const BatchWitnessMessageSchema = z.object({\n  owner: AddressSchema,\n  items: z.array(PaymentItemSchema),\n  deadline: BigIntStringSchema,\n  paymentId: HexSchema,\n  nonce: BigIntStringSchema,\n});\n\n/**\n * Authorization tuple schema\n */\nexport const AuthorizationTupleSchema = z.object({\n  chainId: z.number(),\n  address: AddressSchema,\n  nonce: z.number(),\n  yParity: z.number().min(0).max(1),\n  r: HexSchema,\n  s: HexSchema,\n});\n\n/**\n * Payment details schema\n */\nexport const PaymentDetailsSchema = z.object({\n  scheme: PaymentSchemeSchema,\n  networkId: NetworkSchema,\n  token: AddressSchema,\n  amount: BigIntStringSchema,\n  to: AddressSchema,\n  implementationContract: AddressSchema,\n  witness: z.record(z.any()), // Flexible for typed data\n  authorization: z.object({\n    chainId: z.number(),\n    address: AddressSchema,\n    nonce: z.number(),\n  }),\n});\n\n/**\n * Payment required response schema\n */\nexport const PaymentRequiredResponseSchema = z.object({\n  x402Version: z.number(),\n  accepts: z.array(PaymentDetailsSchema),\n  error: z.string().optional(),\n});\n\n/**\n * Signed payment payload schema\n */\nexport const SignedPaymentPayloadSchema = z.object({\n  witnessSignature: HexSchema,\n  authorization: AuthorizationTupleSchema,\n  paymentDetails: PaymentDetailsSchema,\n});\n\n","import type { Hex } from \"viem\";\n\n/**\n * Verification result\n */\nexport interface VerificationResult {\n  /**\n   * Whether the payment is valid\n   */\n  isValid: boolean;\n\n  /**\n   * Reason for invalidity\n   */\n  invalidReason?: string;\n\n  /**\n   * Recovered payer address\n   */\n  payer?: string;\n\n  /**\n   * Additional validation details\n   */\n  details?: {\n    witnessValid: boolean;\n    authorizationValid: boolean;\n    amountValid: boolean;\n    deadlineValid: boolean;\n    recipientValid: boolean;\n  };\n}\n\n/**\n * Settlement result\n */\nexport interface SettlementResult {\n  /**\n   * Whether settlement was successful\n   */\n  success: boolean;\n\n  /**\n   * Transaction hash if successful\n   */\n  txHash?: Hex;\n\n  /**\n   * Error message if failed\n   */\n  error?: string;\n\n  /**\n   * Block number\n   */\n  blockNumber?: bigint;\n}\n\n/**\n * Error reasons for payment validation\n */\nexport const ErrorReason = {\n  INSUFFICIENT_FUNDS: \"insufficient_funds\",\n  INVALID_SIGNATURE: \"invalid_signature\",\n  INVALID_AUTHORIZATION: \"invalid_authorization\",\n  INVALID_AMOUNT: \"invalid_amount\",\n  INVALID_RECIPIENT: \"invalid_recipient\",\n  PAYMENT_EXPIRED: \"payment_expired\",\n  NONCE_REUSED: \"nonce_reused\",\n  INVALID_IMPLEMENTATION: \"invalid_implementation\",\n  INVALID_NETWORK: \"invalid_network\",\n  INVALID_SCHEME: \"invalid_scheme\",\n  UNEXPECTED_ERROR: \"unexpected_error\",\n} as const;\n\nexport type ErrorReasonType = (typeof ErrorReason)[keyof typeof ErrorReason];\n\n","/**\n * Facilitator Client for q402 Protocol\n * \n * HTTP client for communicating with facilitator services.\n * This replaces the local facilitator logic in core package.\n */\n\nimport type { SignedPaymentPayload } from \"../types/payment\";\n\n/**\n * Facilitator API response types (matching x402 standard)\n */\nexport interface FacilitatorVerificationResponse {\n  isValid: boolean;\n  invalidReason?: string;\n  payer?: string;\n  details?: {\n    witnessValid: boolean;\n    authorizationValid: boolean;\n    amountValid: boolean;\n    deadlineValid: boolean;\n    recipientValid: boolean;\n  };\n}\n\nexport interface FacilitatorSettlementResponse {\n  success: boolean;\n  txHash?: string;\n  blockNumber?: string;\n  error?: string;\n}\n\nexport interface FacilitatorSupportedResponse {\n  kinds: Array<{\n    scheme: string;\n    network: string;\n  }>;\n}\n\n/**\n * Standard x402 facilitator client\n */\nexport class FacilitatorClient {\n  constructor(private readonly baseUrl: string) {\n    if (!baseUrl) {\n      throw new Error(\"Facilitator base URL is required\");\n    }\n  }\n\n  /**\n   * Verify a payment payload with the facilitator\n   * POST /verify endpoint\n   */\n  async verify(payload: SignedPaymentPayload): Promise<FacilitatorVerificationResponse> {\n    try {\n      const response = await fetch(`${this.baseUrl}/verify`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(payload),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({})) as any;\n        throw new Error(`Facilitator verification failed: ${response.status} - ${errorData.message || response.statusText}`);\n      }\n\n      return await response.json() as FacilitatorVerificationResponse;\n    } catch (error) {\n      if (error instanceof Error) {\n        throw error;\n      }\n      throw new Error(`Network error during verification: ${error}`);\n    }\n  }\n\n  /**\n   * Settle a payment through the facilitator\n   * POST /settle endpoint\n   */\n  async settle(payload: SignedPaymentPayload): Promise<FacilitatorSettlementResponse> {\n    try {\n      const response = await fetch(`${this.baseUrl}/settle`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(payload),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({})) as any;\n        throw new Error(`Facilitator settlement failed: ${response.status} - ${errorData.message || response.statusText}`);\n      }\n\n      return await response.json() as FacilitatorSettlementResponse;\n    } catch (error) {\n      if (error instanceof Error) {\n        throw error;\n      }\n      throw new Error(`Network error during settlement: ${error}`);\n    }\n  }\n\n  /**\n   * Get supported payment schemes and networks\n   * GET /supported endpoint\n   */\n  async getSupported(): Promise<FacilitatorSupportedResponse> {\n    try {\n      const response = await fetch(`${this.baseUrl}/supported`, {\n        method: \"GET\",\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({})) as any;\n        throw new Error(`Failed to get supported schemes: ${response.status} - ${errorData.message || response.statusText}`);\n      }\n\n      return await response.json() as FacilitatorSupportedResponse;\n    } catch (error) {\n      if (error instanceof Error) {\n        throw error;\n      }\n      throw new Error(`Network error getting supported schemes: ${error}`);\n    }\n  }\n\n  /**\n   * Health check endpoint\n   */\n  async health(): Promise<{ status: string }> {\n    try {\n      const response = await fetch(`${this.baseUrl}/health`, {\n        method: \"GET\",\n      });\n\n      if (!response.ok) {\n        throw new Error(`Health check failed: ${response.status}`);\n      }\n\n      return await response.json() as { status: string };\n    } catch (error) {\n      if (error instanceof Error) {\n        throw error;\n      }\n        throw new Error(`Health check error: ${String(error)}`);\n      }\n  }\n}\n\n/**\n * Default facilitator client instance\n * Can be configured via environment variables\n */\nexport function createFacilitatorClient(baseUrl?: string): FacilitatorClient {\n  const url = baseUrl || process.env.FACILITATOR_URL || \"http://localhost:8080\";\n  return new FacilitatorClient(url);\n}\n\n/**\n * Convenience functions for direct API calls\n */\nexport async function verifyPaymentWithFacilitator(\n  payload: SignedPaymentPayload,\n  facilitatorUrl?: string,\n): Promise<FacilitatorVerificationResponse> {\n  const client = createFacilitatorClient(facilitatorUrl);\n  return await client.verify(payload);\n}\n\nexport async function settlePaymentWithFacilitator(\n  payload: SignedPaymentPayload,\n  facilitatorUrl?: string,\n): Promise<FacilitatorSettlementResponse> {\n  const client = createFacilitatorClient(facilitatorUrl);\n  return await client.settle(payload);\n}\n","import { randomBytes } from \"crypto\";\nimport { bytesToBigInt } from \"viem\";\n\n/**\n * Generate a random nonce for payment\n * Uses cryptographically secure random bytes\n */\nexport function generateNonce(): bigint {\n  const bytes = randomBytes(32);\n  return bytesToBigInt(bytes);\n}\n\n/**\n * Generate a payment ID (32-byte hex string)\n */\nexport function generatePaymentId(): `0x${string}` {\n  const bytes = randomBytes(32);\n  return `0x${bytes.toString(\"hex\")}`;\n}\n\n/**\n * Generate an authorization nonce (uint64)\n */\nexport function generateAuthNonce(): bigint {\n  const bytes = randomBytes(8);\n  return bytesToBigInt(bytes);\n}\n\n","import type { Address, Hex } from \"viem\";\nimport { isAddress, isHex } from \"viem\";\n\n/**\n * Validate Ethereum address\n */\nexport function validateAddress(address: unknown): address is Address {\n  return typeof address === \"string\" && isAddress(address);\n}\n\n/**\n * Validate hex string\n */\nexport function validateHex(value: unknown): value is Hex {\n  return typeof value === \"string\" && isHex(value);\n}\n\n/**\n * Validate bigint or bigint string\n */\nexport function validateBigInt(value: unknown): boolean {\n  if (typeof value === \"bigint\") {\n    return value >= 0n;\n  }\n  if (typeof value === \"string\") {\n    return /^\\d+$/.test(value);\n  }\n  return false;\n}\n\n/**\n * Validate deadline (must be in the future)\n */\nexport function validateDeadline(deadline: bigint): boolean {\n  const now = BigInt(Math.floor(Date.now() / 1000));\n  return deadline > now;\n}\n\n/**\n * Validate amount (must be positive)\n */\nexport function validateAmount(amount: bigint): boolean {\n  return amount > 0n;\n}\n\n/**\n * Parse bigint from string or bigint\n */\nexport function parseBigInt(value: string | bigint): bigint {\n  return typeof value === \"bigint\" ? value : BigInt(value);\n}\n\n","/**\n * Base error class for q402 errors\n */\nexport class Q402Error extends Error {\n  constructor(\n    message: string,\n    public readonly code: string,\n    public readonly details?: unknown,\n  ) {\n    super(message);\n    this.name = \"Q402Error\";\n  }\n}\n\n/**\n * Payment validation error\n */\nexport class PaymentValidationError extends Q402Error {\n  constructor(message: string, details?: unknown) {\n    super(message, \"PAYMENT_VALIDATION_ERROR\", details);\n    this.name = \"PaymentValidationError\";\n  }\n}\n\n/**\n * Signature error\n */\nexport class SignatureError extends Q402Error {\n  constructor(message: string, details?: unknown) {\n    super(message, \"SIGNATURE_ERROR\", details);\n    this.name = \"SignatureError\";\n  }\n}\n\n/**\n * Network error\n */\nexport class NetworkError extends Q402Error {\n  constructor(message: string, details?: unknown) {\n    super(message, \"NETWORK_ERROR\", details);\n    this.name = \"NetworkError\";\n  }\n}\n\n/**\n * Transaction error\n */\nexport class TransactionError extends Q402Error {\n  constructor(message: string, details?: unknown) {\n    super(message, \"TRANSACTION_ERROR\", details);\n    this.name = \"TransactionError\";\n  }\n}\n\n","import type { Address, Hex } from \"viem\";\nimport type { WitnessMessage, BatchWitnessMessage, PaymentItem } from \"../types/eip712\";\nimport { generateNonce, generatePaymentId } from \"../utils/nonce\";\nimport { validateAddress, validateAmount } from \"../utils/validation\";\nimport { PaymentValidationError } from \"../utils/errors\";\n\n/**\n * Options for preparing witness message\n */\nexport interface PrepareWitnessOptions {\n  /**\n   * Owner/payer address\n   */\n  owner: Address;\n\n  /**\n   * Token contract address\n   */\n  token: Address;\n\n  /**\n   * Amount in atomic units\n   */\n  amount: bigint | string;\n\n  /**\n   * Recipient address\n   */\n  to: Address;\n\n  /**\n   * Optional deadline (default: 15 minutes from now)\n   */\n  deadline?: bigint;\n\n  /**\n   * Optional payment ID (auto-generated if not provided)\n   */\n  paymentId?: Hex;\n\n  /**\n   * Optional nonce (auto-generated if not provided)\n   */\n  nonce?: bigint;\n}\n\n/**\n * Prepare a witness message for single payment\n */\nexport function prepareWitness(options: PrepareWitnessOptions): WitnessMessage {\n  const { owner, token, amount, to, deadline, paymentId, nonce } = options;\n\n  // Validate inputs\n  if (!validateAddress(owner)) {\n    throw new PaymentValidationError(\"Invalid owner address\");\n  }\n  if (!validateAddress(token)) {\n    throw new PaymentValidationError(\"Invalid token address\");\n  }\n  if (!validateAddress(to)) {\n    throw new PaymentValidationError(\"Invalid recipient address\");\n  }\n\n  const amountBigInt = typeof amount === \"string\" ? BigInt(amount) : amount;\n  if (!validateAmount(amountBigInt)) {\n    throw new PaymentValidationError(\"Invalid amount\");\n  }\n\n  // Generate defaults\n  const finalDeadline = deadline ?? BigInt(Math.floor(Date.now() / 1000) + 900); // 15 minutes\n  const finalPaymentId = paymentId ?? generatePaymentId();\n  const finalNonce = nonce ?? generateNonce();\n\n  return {\n    owner,\n    token,\n    amount: amountBigInt,\n    to,\n    deadline: finalDeadline,\n    paymentId: finalPaymentId,\n    nonce: finalNonce,\n  };\n}\n\n/**\n * Options for preparing batch witness message\n */\nexport interface PrepareBatchWitnessOptions {\n  owner: Address;\n  items: PaymentItem[];\n  deadline?: bigint;\n  paymentId?: Hex;\n  nonce?: bigint;\n}\n\n/**\n * Prepare a batch witness message\n */\nexport function prepareBatchWitness(options: PrepareBatchWitnessOptions): BatchWitnessMessage {\n  const { owner, items, deadline, paymentId, nonce } = options;\n\n  // Validate owner\n  if (!validateAddress(owner)) {\n    throw new PaymentValidationError(\"Invalid owner address\");\n  }\n\n  // Validate items\n  if (!items || items.length === 0) {\n    throw new PaymentValidationError(\"Items array cannot be empty\");\n  }\n\n  for (const item of items) {\n    if (!validateAddress(item.token)) {\n      throw new PaymentValidationError(`Invalid token address: ${item.token}`);\n    }\n    if (!validateAddress(item.to)) {\n      throw new PaymentValidationError(`Invalid recipient address: ${item.to}`);\n    }\n    if (!validateAmount(item.amount)) {\n      throw new PaymentValidationError(`Invalid amount: ${item.amount}`);\n    }\n  }\n\n  // Generate defaults\n  const finalDeadline = deadline ?? BigInt(Math.floor(Date.now() / 1000) + 900); // 15 minutes\n  const finalPaymentId = paymentId ?? generatePaymentId();\n  const finalNonce = nonce ?? generateNonce();\n\n  return {\n    owner,\n    items,\n    deadline: finalDeadline,\n    paymentId: finalPaymentId,\n    nonce: finalNonce,\n  };\n}\n\n","import type { Hex, WalletClient, LocalAccount, PrivateKeyAccount } from \"viem\";\nimport { signTypedData } from \"viem/actions\";\nimport type {\n  WitnessMessage,\n  BatchWitnessMessage,\n  Eip712Domain,\n} from \"../types/eip712\";\nimport { SignatureError } from \"../utils/errors\";\n\n/**\n * Sign a witness message using EIP-712\n */\nexport async function signWitness(\n  account: LocalAccount | PrivateKeyAccount,\n  domain: Eip712Domain,\n  message: WitnessMessage,\n): Promise<Hex> {\n  try {\n    const signature = await account.signTypedData({\n      domain: {\n        name: domain.name,\n        version: domain.version,\n        chainId: domain.chainId,\n        verifyingContract: domain.verifyingContract,\n      },\n      types: {\n        Witness: [\n          { name: \"owner\", type: \"address\" },\n          { name: \"token\", type: \"address\" },\n          { name: \"amount\", type: \"uint256\" },\n          { name: \"to\", type: \"address\" },\n          { name: \"deadline\", type: \"uint256\" },\n          { name: \"paymentId\", type: \"bytes32\" },\n          { name: \"nonce\", type: \"uint256\" },\n        ],\n      },\n      primaryType: \"Witness\",\n      message: {\n        owner: message.owner,\n        token: message.token,\n        amount: message.amount,\n        to: message.to,\n        deadline: message.deadline,\n        paymentId: message.paymentId,\n        nonce: message.nonce,\n      },\n    });\n\n    return signature;\n  } catch (error) {\n    throw new SignatureError(\"Failed to sign witness message\", error);\n  }\n}\n\n/**\n * Sign a witness message using wallet client\n */\nexport async function signWitnessWithWallet(\n  walletClient: WalletClient,\n  domain: Eip712Domain,\n  message: WitnessMessage,\n): Promise<Hex> {\n  try {\n    if (!walletClient.account) {\n      throw new SignatureError(\"Wallet client has no account\");\n    }\n\n    const signature = await signTypedData(walletClient, {\n      account: walletClient.account,\n      domain: {\n        name: domain.name,\n        version: domain.version,\n        chainId: domain.chainId,\n        verifyingContract: domain.verifyingContract,\n      },\n      types: {\n        Witness: [\n          { name: \"owner\", type: \"address\" },\n          { name: \"token\", type: \"address\" },\n          { name: \"amount\", type: \"uint256\" },\n          { name: \"to\", type: \"address\" },\n          { name: \"deadline\", type: \"uint256\" },\n          { name: \"paymentId\", type: \"bytes32\" },\n          { name: \"nonce\", type: \"uint256\" },\n        ],\n      },\n      primaryType: \"Witness\",\n      message: {\n        owner: message.owner,\n        token: message.token,\n        amount: message.amount,\n        to: message.to,\n        deadline: message.deadline,\n        paymentId: message.paymentId,\n        nonce: message.nonce,\n      },\n    });\n\n    return signature;\n  } catch (error) {\n    throw new SignatureError(\"Failed to sign witness message with wallet\", error);\n  }\n}\n\n/**\n * Sign a batch witness message\n */\nexport async function signBatchWitness(\n  account: LocalAccount | PrivateKeyAccount,\n  domain: Eip712Domain,\n  message: BatchWitnessMessage,\n): Promise<Hex> {\n  try {\n    const signature = await account.signTypedData({\n      domain: {\n        name: domain.name,\n        version: domain.version,\n        chainId: domain.chainId,\n        verifyingContract: domain.verifyingContract,\n      },\n      types: {\n        PaymentItem: [\n          { name: \"token\", type: \"address\" },\n          { name: \"amount\", type: \"uint256\" },\n          { name: \"to\", type: \"address\" },\n        ],\n        BatchWitness: [\n          { name: \"owner\", type: \"address\" },\n          { name: \"items\", type: \"PaymentItem[]\" },\n          { name: \"deadline\", type: \"uint256\" },\n          { name: \"paymentId\", type: \"bytes32\" },\n          { name: \"nonce\", type: \"uint256\" },\n        ],\n      },\n      primaryType: \"BatchWitness\",\n      message,\n    });\n\n    return signature;\n  } catch (error) {\n    throw new SignatureError(\"Failed to sign batch witness message\", error);\n  }\n}\n\n","import type { Address } from \"viem\";\nimport type { UnsignedAuthorizationTuple } from \"../types/eip7702\";\nimport { generateAuthNonce } from \"../utils/nonce\";\nimport { validateAddress } from \"../utils/validation\";\nimport { PaymentValidationError } from \"../utils/errors\";\n\n/**\n * Options for preparing authorization tuple\n */\nexport interface PrepareAuthorizationOptions {\n  /**\n   * Chain ID (0 for any chain, or specific chain ID)\n   */\n  chainId: bigint | number;\n\n  /**\n   * Implementation contract address to delegate to\n   */\n  implementationAddress: Address;\n\n  /**\n   * Optional authorization nonce (auto-generated if not provided)\n   */\n  nonce?: bigint | number;\n}\n\n/**\n * Prepare an unsigned authorization tuple for EIP-7702\n */\nexport function prepareAuthorization(\n  options: PrepareAuthorizationOptions,\n): UnsignedAuthorizationTuple {\n  const { chainId, implementationAddress, nonce } = options;\n\n  // Validate implementation address\n  if (!validateAddress(implementationAddress)) {\n    throw new PaymentValidationError(\"Invalid implementation contract address\");\n  }\n\n  // Convert chain ID to bigint\n  const chainIdBigInt = typeof chainId === \"number\" ? BigInt(chainId) : chainId;\n\n  // Generate nonce if not provided\n  const finalNonce =\n    nonce !== undefined\n      ? typeof nonce === \"number\"\n        ? BigInt(nonce)\n        : nonce\n      : generateAuthNonce();\n\n  return {\n    chainId: chainIdBigInt,\n    address: implementationAddress,\n    nonce: finalNonce,\n  };\n}\n\n","import type { Hex, LocalAccount, PrivateKeyAccount } from \"viem\";\nimport { keccak256, concat, toRlp } from \"viem\";\nimport type { UnsignedAuthorizationTuple, AuthorizationTuple } from \"../types/eip7702\";\nimport { SignatureError } from \"../utils/errors\";\n\n/**\n * Sign an authorization tuple for EIP-7702\n * Computes: keccak256(0x05 || rlp([chain_id, address, nonce]))\n */\nexport async function signAuthorization(\n  account: LocalAccount | PrivateKeyAccount,\n  authorization: UnsignedAuthorizationTuple,\n): Promise<AuthorizationTuple> {\n  try {\n    // Encode authorization data\n    const encoded = toRlp([\n      authorization.chainId === 0n ? \"0x\" : `0x${authorization.chainId.toString(16)}`,\n      authorization.address,\n      authorization.nonce === 0n ? \"0x\" : `0x${authorization.nonce.toString(16)}`,\n    ]);\n\n    // Prepend 0x05 type prefix\n    const message = concat([\"0x05\", encoded]);\n\n    // Hash the message\n    const hash = keccak256(message);\n\n    // Sign the hash\n    const signature = await account.signMessage({\n      message: { raw: hash },\n    });\n\n    // Parse signature (viem returns r,s,v format)\n    const r = signature.slice(0, 66) as Hex;\n    const s = `0x${signature.slice(66, 130)}` as Hex;\n    const v = parseInt(signature.slice(130, 132), 16);\n\n    // Convert v to y_parity (27/28 -> 0/1)\n    const yParity = v >= 27 ? v - 27 : v;\n\n    return {\n      chainId: authorization.chainId,\n      address: authorization.address,\n      nonce: authorization.nonce,\n      yParity,\n      r,\n      s,\n    };\n  } catch (error) {\n    throw new SignatureError(\"Failed to sign authorization tuple\", error);\n  }\n}\n\n/**\n * Verify an authorization signature\n */\nexport async function verifyAuthorizationSignature(\n  authorization: AuthorizationTuple,\n  expectedSigner: Hex,\n): Promise<boolean> {\n  try {\n    const { recoverMessageAddress } = await import(\"viem\");\n    \n    // Encode authorization data\n    const encoded = toRlp([\n      authorization.chainId === 0n ? \"0x\" : `0x${authorization.chainId.toString(16)}`,\n      authorization.address,\n      authorization.nonce === 0n ? \"0x\" : `0x${authorization.nonce.toString(16)}`,\n    ]);\n\n    // Prepend 0x05 type prefix\n    const message = concat([\"0x05\", encoded]);\n\n    // Hash the message\n    const hash = keccak256(message);\n\n    // Reconstruct signature from components\n    const v = authorization.yParity + 27;\n    const signature = concat([\n      authorization.r,\n      authorization.s,\n      `0x${v.toString(16).padStart(2, \"0\")}` as Hex,\n    ]);\n\n    // Recover signer address\n    const recovered = await recoverMessageAddress({\n      message: { raw: hash },\n      signature,\n    });\n\n    // Verify signer matches expected\n    return recovered.toLowerCase() === expectedSigner.toLowerCase();\n  } catch {\n    return false;\n  }\n}\n\n","import { base64 } from \"@scure/base\";\nimport type { Hex } from \"viem\";\n\n/**\n * Encode data to base64 string\n */\nexport function encodeBase64(data: string | object): string {\n  const str = typeof data === \"string\" ? data : JSON.stringify(data);\n  const bytes = new TextEncoder().encode(str);\n  return base64.encode(bytes);\n}\n\n/**\n * Decode base64 string to object\n */\nexport function decodeBase64<T = unknown>(encoded: string): T {\n  const bytes = base64.decode(encoded);\n  const str = new TextDecoder().decode(bytes);\n  return JSON.parse(str) as T;\n}\n\n/**\n * RLP encode authorization tuple for EIP-7702\n * Format: rlp([chain_id, address, nonce])\n */\nexport function rlpEncodeAuthorization(\n  chainId: bigint,\n  address: Hex,\n  nonce: bigint,\n): Uint8Array {\n  // Simple RLP encoding for authorization tuple\n  // This is a basic implementation - in production, use a proper RLP library\n  const items = [\n    encodeRlpItem(chainId),\n    encodeRlpItem(address),\n    encodeRlpItem(nonce),\n  ];\n\n  return encodeRlpList(items);\n}\n\n/**\n * Encode a single RLP item\n */\nfunction encodeRlpItem(value: bigint | string): Uint8Array {\n  if (typeof value === \"bigint\") {\n    // Encode bigint as bytes\n    if (value === 0n) {\n      return new Uint8Array([0x80]); // Empty string\n    }\n    const hex = value.toString(16).padStart(value.toString(16).length % 2 === 0 ? 0 : 1, \"0\");\n    const bytes = hexToBytes(hex);\n    return encodeRlpString(bytes);\n  } else {\n    // Encode hex string\n    const bytes = hexToBytes(value.replace(/^0x/, \"\"));\n    return encodeRlpString(bytes);\n  }\n}\n\n/**\n * Encode RLP string\n */\nfunction encodeRlpString(bytes: Uint8Array): Uint8Array {\n  if (bytes.length === 1 && bytes[0] < 0x80) {\n    return bytes;\n  }\n  if (bytes.length <= 55) {\n    return new Uint8Array([0x80 + bytes.length, ...bytes]);\n  }\n  const lengthBytes = numberToBytes(bytes.length);\n  return new Uint8Array([0xb7 + lengthBytes.length, ...lengthBytes, ...bytes]);\n}\n\n/**\n * Encode RLP list\n */\nfunction encodeRlpList(items: Uint8Array[]): Uint8Array {\n  const concatenated = new Uint8Array(items.reduce((acc, item) => acc + item.length, 0));\n  let offset = 0;\n  for (const item of items) {\n    concatenated.set(item, offset);\n    offset += item.length;\n  }\n\n  if (concatenated.length <= 55) {\n    return new Uint8Array([0xc0 + concatenated.length, ...concatenated]);\n  }\n  const lengthBytes = numberToBytes(concatenated.length);\n  return new Uint8Array([0xf7 + lengthBytes.length, ...lengthBytes, ...concatenated]);\n}\n\n/**\n * Convert hex string to bytes\n */\nfunction hexToBytes(hex: string): Uint8Array {\n  const bytes = new Uint8Array(hex.length / 2);\n  for (let i = 0; i < hex.length; i += 2) {\n    bytes[i / 2] = parseInt(hex.slice(i, i + 2), 16);\n  }\n  return bytes;\n}\n\n/**\n * Convert number to bytes\n */\nfunction numberToBytes(num: number): Uint8Array {\n  const hex = num.toString(16).padStart(num.toString(16).length % 2 === 0 ? 0 : 1, \"0\");\n  return hexToBytes(hex);\n}\n\n","import type { LocalAccount, PrivateKeyAccount, WalletClient } from \"viem\";\nimport type { PaymentDetails, SignedPaymentPayload } from \"../types/payment\";\nimport type { Eip712Domain } from \"../types/eip712\";\nimport { prepareWitness } from \"./prepareWitness\";\nimport { signWitness, signWitnessWithWallet } from \"./signWitness\";\nimport { prepareAuthorization } from \"./prepareAuthorization\";\nimport { signAuthorization } from \"./signAuthorization\";\nimport { encodeBase64 } from \"../utils/encoding\";\n\n/**\n * Create a complete payment header for X-PAYMENT\n */\nexport async function createPaymentHeader(\n  account: LocalAccount | PrivateKeyAccount,\n  paymentDetails: PaymentDetails,\n): Promise<string> {\n  // Prepare witness message\n  const witnessMessage = prepareWitness({\n    owner: account.address,\n    token: paymentDetails.token,\n    amount: paymentDetails.amount,\n    to: paymentDetails.to,\n  });\n\n  // Create domain from payment details\n  const domain: Eip712Domain = {\n    name: \"q402\",\n    version: \"1\",\n    chainId: paymentDetails.authorization.chainId,\n    verifyingContract: paymentDetails.authorization.address,\n  };\n\n  // Sign witness\n  const witnessSignature = await signWitness(account, domain, witnessMessage);\n\n  // Prepare authorization\n  const unsignedAuth = prepareAuthorization({\n    chainId: paymentDetails.authorization.chainId,\n    implementationAddress: paymentDetails.implementationContract,\n    nonce: paymentDetails.authorization.nonce,\n  });\n\n  // Sign authorization\n  const signedAuth = await signAuthorization(account, unsignedAuth);\n\n  // Create signed payload\n  const payload: SignedPaymentPayload = {\n    witnessSignature,\n    authorization: signedAuth,\n    paymentDetails,\n  };\n\n  // Encode to base64 for X-PAYMENT header\n  return encodeBase64(payload);\n}\n\n/**\n * Create payment header using wallet client\n */\nexport async function createPaymentHeaderWithWallet(\n  walletClient: WalletClient,\n  paymentDetails: PaymentDetails,\n): Promise<string> {\n  if (!walletClient.account) {\n    throw new Error(\"Wallet client has no account\");\n  }\n\n  // Prepare witness message\n  const witnessMessage = prepareWitness({\n    owner: walletClient.account.address,\n    token: paymentDetails.token,\n    amount: paymentDetails.amount,\n    to: paymentDetails.to,\n  });\n\n  // Create domain\n  const domain: Eip712Domain = {\n    name: \"q402\",\n    version: \"1\",\n    chainId: paymentDetails.authorization.chainId,\n    verifyingContract: paymentDetails.authorization.address,\n  };\n\n  // Sign witness\n  const witnessSignature = await signWitnessWithWallet(walletClient, domain, witnessMessage);\n\n  // For authorization, we need to use the account\n  const unsignedAuth = prepareAuthorization({\n    chainId: paymentDetails.authorization.chainId,\n    implementationAddress: paymentDetails.implementationContract,\n    nonce: paymentDetails.authorization.nonce,\n  });\n\n  // Sign authorization (requires LocalAccount)\n  const signedAuth = await signAuthorization(\n    walletClient.account as LocalAccount | PrivateKeyAccount,\n    unsignedAuth,\n  );\n\n  // Create signed payload\n  const payload: SignedPaymentPayload = {\n    witnessSignature,\n    authorization: signedAuth,\n    paymentDetails,\n  };\n\n  return encodeBase64(payload);\n}\n\n","import type { PaymentRequiredResponse, PaymentDetails } from \"../types/payment\";\nimport { PaymentScheme } from \"../types/payment\";\nimport type { SupportedNetwork } from \"../types/network\";\n\n/**\n * Options for selecting payment details\n */\nexport interface SelectPaymentDetailsOptions {\n  /**\n   * Preferred network (optional)\n   */\n  network?: SupportedNetwork;\n\n  /**\n   * Preferred scheme (optional)\n   */\n  scheme?: string;\n\n  /**\n   * Maximum amount willing to pay (optional)\n   */\n  maxAmount?: bigint;\n}\n\n/**\n * Select payment details from 402 response\n * Returns the first matching payment option, or the first available if no preferences match\n */\nexport function selectPaymentDetails(\n  response: PaymentRequiredResponse,\n  options?: SelectPaymentDetailsOptions,\n): PaymentDetails | null {\n  if (!response.accepts || response.accepts.length === 0) {\n    return null;\n  }\n\n  const { network, scheme, maxAmount } = options ?? {};\n\n  // Filter by preferences\n  let candidates = response.accepts;\n\n  if (network) {\n    const filtered = candidates.filter((details) => details.networkId === network);\n    if (filtered.length > 0) {\n      candidates = filtered;\n    }\n  }\n\n  if (scheme) {\n    const filtered = candidates.filter((details) => details.scheme === scheme);\n    if (filtered.length > 0) {\n      candidates = filtered;\n    }\n  }\n\n  if (maxAmount !== undefined) {\n    const filtered = candidates.filter((details) => BigInt(details.amount) <= maxAmount);\n    if (filtered.length > 0) {\n      candidates = filtered;\n    }\n  }\n\n  // Return first candidate\n  return candidates[0] ?? null;\n}\n\n/**\n * Check if payment details are supported by this client\n */\nexport function isPaymentDetailsSupported(details: PaymentDetails): boolean {\n  // Check scheme\n  const supportedSchemes = [PaymentScheme.EIP7702_DELEGATED, PaymentScheme.EIP7702_DELEGATED_BATCH];\n  if (!supportedSchemes.includes(details.scheme as (typeof supportedSchemes)[number])) {\n    return false;\n  }\n\n  // Check network (BSC mainnet/testnet)\n  const supportedNetworks = [\"bsc-mainnet\", \"bsc-testnet\"];\n  if (!supportedNetworks.includes(details.networkId)) {\n    return false;\n  }\n\n  return true;\n}\n\n","/**\n * Resource Server Helper for q402 Protocol\n * \n * Helper functions for resource servers implementing x402 payment flow\n */\n\nimport type { PaymentRequiredResponse, PaymentDetails } from \"../types/payment\";\n\n/**\n * Standard x402 payment header format\n */\nexport interface PaymentHeader {\n  x402Version: number;\n  scheme: string;\n  network: string;\n  payload: unknown;\n}\n\n/**\n * Standard x402 payment requirement format\n */\nexport interface PaymentRequirement {\n  scheme: string;\n  network: string;\n  maxAmountRequired: string;\n  resource: string;\n  description: string;\n  mimeType: string;\n  payTo: string;\n  maxTimeoutSeconds: number;\n  asset: string;\n  extra?: object;\n}\n\n/**\n * Create a 402 Payment Required response\n */\nexport function createPaymentRequired(\n  accepts: PaymentDetails[],\n  error?: string,\n): PaymentRequiredResponse {\n  return {\n    x402Version: 1,\n    accepts,\n    error,\n  };\n}\n\n/**\n * Parse X-PAYMENT header\n */\nexport function parsePaymentHeader(header: string): PaymentHeader {\n  try {\n    const decoded = Buffer.from(header, 'base64').toString('utf8');\n    return JSON.parse(decoded);\n  } catch (error) {\n    throw new Error(`Invalid X-PAYMENT header: ${error}`);\n  }\n}\n\n/**\n * Create X-PAYMENT-RESPONSE header content\n */\nexport function createPaymentResponse(\n  success: boolean,\n  options?: {\n    error?: string;\n    txHash?: string;\n    networkId?: string;\n    blockNumber?: string;\n  },\n): string {\n  const response = {\n    success,\n    ...options,\n  };\n  \n  return Buffer.from(JSON.stringify(response)).toString('base64');\n}\n\n/**\n * Validate payment header against requirements\n */\nexport function validatePaymentHeader(\n  header: PaymentHeader,\n  requirement: PaymentRequirement,\n): { isValid: boolean; reason?: string } {\n  if (header.scheme !== requirement.scheme) {\n    return { isValid: false, reason: `Scheme mismatch: expected ${requirement.scheme}, got ${header.scheme}` };\n  }\n  \n  if (header.network !== requirement.network) {\n    return { isValid: false, reason: `Network mismatch: expected ${requirement.network}, got ${header.network}` };\n  }\n  \n  if (header.x402Version !== 1) {\n    return { isValid: false, reason: `Unsupported x402 version: ${header.x402Version}` };\n  }\n  \n  return { isValid: true };\n}\n\n/**\n * Create payment requirement for EIP-7702 delegated payments\n */\nexport function createEip7702PaymentRequirement(\n  amount: string,\n  tokenAddress: string,\n  recipientAddress: string,\n  resource: string,\n  description: string,\n  network: string = \"bsc-mainnet\",\n  mimeType: string = \"application/json\",\n): PaymentRequirement {\n  return {\n    scheme: \"evm/eip7702-signature-based\",\n    network,\n    maxAmountRequired: amount,\n    resource,\n    description,\n    mimeType,\n    payTo: recipientAddress,\n    maxTimeoutSeconds: 60,\n    asset: tokenAddress,\n    extra: {\n      name: \"q402\",\n      version: \"1\",\n    },\n  };\n}\n","/**\n * ABI for EIP-7702 delegated payment implementation contract\n */\nexport const PaymentImplementationAbi = [\n  {\n    type: \"function\",\n    name: \"pay\",\n    stateMutability: \"nonpayable\",\n    inputs: [\n      { name: \"owner\", type: \"address\" },\n      { name: \"token\", type: \"address\" },\n      { name: \"amount\", type: \"uint256\" },\n      { name: \"to\", type: \"address\" },\n      { name: \"deadline\", type: \"uint256\" },\n      { name: \"paymentId\", type: \"bytes32\" },\n      { name: \"witnessSig\", type: \"bytes\" },\n    ],\n    outputs: [],\n  },\n  {\n    type: \"function\",\n    name: \"payBatch\",\n    stateMutability: \"nonpayable\",\n    inputs: [\n      { name: \"owner\", type: \"address\" },\n      {\n        name: \"items\",\n        type: \"tuple[]\",\n        components: [\n          { name: \"token\", type: \"address\" },\n          { name: \"amount\", type: \"uint256\" },\n          { name: \"to\", type: \"address\" },\n        ],\n      },\n      { name: \"deadline\", type: \"uint256\" },\n      { name: \"paymentId\", type: \"bytes32\" },\n      { name: \"witnessSig\", type: \"bytes\" },\n    ],\n    outputs: [],\n  },\n  {\n    type: \"event\",\n    name: \"Payment\",\n    inputs: [\n      { name: \"owner\", type: \"address\", indexed: true },\n      { name: \"token\", type: \"address\", indexed: true },\n      { name: \"to\", type: \"address\", indexed: true },\n      { name: \"amount\", type: \"uint256\", indexed: false },\n      { name: \"paymentId\", type: \"bytes32\", indexed: false },\n    ],\n  },\n  {\n    type: \"event\",\n    name: \"BatchPayment\",\n    inputs: [\n      { name: \"owner\", type: \"address\", indexed: true },\n      { name: \"paymentId\", type: \"bytes32\", indexed: false },\n      { name: \"itemCount\", type: \"uint256\", indexed: false },\n    ],\n  },\n] as const;\n\n/**\n * Standard ERC-20 ABI (minimal)\n */\nexport const Erc20Abi = [\n  {\n    type: \"function\",\n    name: \"balanceOf\",\n    stateMutability: \"view\",\n    inputs: [{ name: \"account\", type: \"address\" }],\n    outputs: [{ name: \"\", type: \"uint256\" }],\n  },\n  {\n    type: \"function\",\n    name: \"transfer\",\n    stateMutability: \"nonpayable\",\n    inputs: [\n      { name: \"to\", type: \"address\" },\n      { name: \"amount\", type: \"uint256\" },\n    ],\n    outputs: [{ name: \"\", type: \"bool\" }],\n  },\n  {\n    type: \"function\",\n    name: \"allowance\",\n    stateMutability: \"view\",\n    inputs: [\n      { name: \"owner\", type: \"address\" },\n      { name: \"spender\", type: \"address\" },\n    ],\n    outputs: [{ name: \"\", type: \"uint256\" }],\n  },\n  {\n    type: \"event\",\n    name: \"Transfer\",\n    inputs: [\n      { name: \"from\", type: \"address\", indexed: true },\n      { name: \"to\", type: \"address\", indexed: true },\n      { name: \"value\", type: \"uint256\", indexed: false },\n    ],\n  },\n] as const;\n\n","/**\n * Payment verification logic for facilitator services\n * (Migrated from facilitator package)\n */\n\nimport type { SignedPaymentPayload } from \"../types/payment\";\nimport type { VerificationResult } from \"../types/responses\";\nimport { ErrorReason } from \"../types/responses\";\n\n/**\n * Core payment verification function\n * \n * This function validates:\n * 1. Basic payload validation\n * 2. Deadline checks\n * 3. Signature format validation\n * 4. Authorization format validation\n * 5. Payment parameters validation\n */\nexport async function verifyPayment(\n  payload: SignedPaymentPayload,\n): Promise<VerificationResult> {\n  try {\n    const { witnessSignature, authorization, paymentDetails } = payload;\n    \n    // 1. Basic payload validation\n    if (!witnessSignature || !authorization || !paymentDetails) {\n      return {\n        isValid: false,\n        invalidReason: ErrorReason.INVALID_SIGNATURE,\n      };\n    }\n\n    // 2. Check deadline (from witness message)\n    const now = Math.floor(Date.now() / 1000);\n    const witness = paymentDetails.witness as any;\n    if (witness?.message?.deadline && now > Number(witness.message.deadline)) {\n      return {\n        isValid: false,\n        invalidReason: ErrorReason.PAYMENT_EXPIRED,\n      };\n    }\n\n    // 3. Verify basic signature format\n    const witnessValid = isValidSignature(witnessSignature);\n    const authorizationValid = isValidAuthorization(authorization);\n\n    if (!witnessValid) {\n      return {\n        isValid: false,\n        invalidReason: ErrorReason.INVALID_SIGNATURE,\n      };\n    }\n\n    if (!authorizationValid) {\n      return {\n        isValid: false,\n        invalidReason: ErrorReason.INVALID_AUTHORIZATION,\n      };\n    }\n\n    // 4. Verify amounts and recipients\n    const amountValid = 'amount' in paymentDetails ? isValidAmount(paymentDetails.amount) : true; // Batch payments don't have single amount\n    const recipientValid = isValidRecipient(paymentDetails.to);\n\n    if (!amountValid) {\n      return {\n        isValid: false,\n        invalidReason: ErrorReason.INVALID_AMOUNT,\n      };\n    }\n\n    if (!recipientValid) {\n      return {\n        isValid: false,\n        invalidReason: ErrorReason.INVALID_RECIPIENT,\n      };\n    }\n\n    // All validations passed\n    return {\n      isValid: true,\n      payer: authorization.address,\n      details: {\n        witnessValid,\n        authorizationValid,\n        amountValid,\n        deadlineValid: true,\n        recipientValid,\n      },\n    };\n    \n  } catch (error) {\n    console.error(\"Payment verification error:\", error);\n    return {\n      isValid: false,\n      invalidReason: ErrorReason.UNEXPECTED_ERROR,\n    };\n  }\n}\n\n/**\n * Validate signature format\n */\nfunction isValidSignature(signature: string): boolean {\n  return (\n    typeof signature === 'string' &&\n    signature.startsWith('0x') &&\n    signature.length === 132 // 65 bytes = 130 hex chars + 0x prefix\n  );\n}\n\n/**\n * Validate EIP-7702 authorization format\n */\nfunction isValidAuthorization(authorization: any): boolean {\n  const { chainId, address, nonce, yParity, r, s } = authorization;\n  \n  return !!(\n    typeof chainId === 'number' && chainId > 0 &&\n    typeof address === 'string' && address.startsWith('0x') && address.length === 42 &&\n    typeof nonce === 'number' && nonce >= 0 &&\n    typeof yParity === 'number' && (yParity === 0 || yParity === 1) &&\n    typeof r === 'string' && r.startsWith('0x') && r.length === 66 &&\n    typeof s === 'string' && s.startsWith('0x') && s.length === 66\n  );\n}\n\n/**\n * Validate payment amount\n */\nfunction isValidAmount(amount: string): boolean {\n  try {\n    const amountBigInt = BigInt(amount);\n    return amountBigInt > 0n;\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Validate recipient address\n */\nfunction isValidRecipient(recipient: string): boolean {\n  return (\n    typeof recipient === 'string' &&\n    recipient.startsWith('0x') &&\n    recipient.length === 42\n  );\n}\n","/**\n * Payment settlement logic for facilitator services\n * (Core settlement function that facilitator services use)\n */\n\nimport type { WalletClient, Hex } from \"viem\";\nimport type { SignedPaymentPayload } from \"../types/payment\";\nimport type { SettlementResult } from \"../types/responses\";\n\n/**\n * Settle a verified payment by executing EIP-7702 transaction on-chain\n * \n * This is the core settlement function that facilitator services call.\n * Note: This is a simplified implementation for testing purposes.\n */\nexport async function settlePayment(\n  _walletClient: WalletClient,\n  _payload: SignedPaymentPayload,\n): Promise<SettlementResult> {\n  try {\n    // For now, return a successful mock settlement\n    // In production, this would execute the EIP-7702 transaction\n    const mockTxHash = `0x${Math.random().toString(16).substring(2, 66).padStart(64, '0')}` as Hex;\n    \n    // Simulate transaction execution delay\n    await new Promise(resolve => setTimeout(resolve, 1000));\n    \n    return {\n      success: true,\n      txHash: mockTxHash,\n      blockNumber: BigInt(12345678),\n    };\n    \n  } catch (error) {\n    console.error(\"Settlement error:\", error);\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : \"Unknown settlement error\",\n    };\n  }\n}\n\n","/**\n * q402 - EIP-7702 Delegated Payment Protocol\n * \n * A production-ready EIP-7702 delegated execution payment flow for BSC and EVM networks,\n * with gas sponsored by facilitators.\n * \n * Inspired by the x402 protocol: https://github.com/coinbase/x402\n * \n * @packageDocumentation\n */\n\nexport * from \"./types\";\nexport * from \"./client\";\nexport * from \"./contracts\";\nexport * from \"./utils\";\nexport * from \"./facilitator\";\n\n/**\n * Protocol version\n */\nexport const X402_BNB_VERSION = 1;\n\n"]}